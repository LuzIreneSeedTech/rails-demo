import r from"strict-uri-encode";import e from"object-assign";import t from"decode-uri-component";var n={};var o=r;var c=e;var a=t;function encoderForArrayFormat(r){switch(r.arrayFormat){case"index":return function(e,t,n){return null===t?[encode(e,r),"[",n,"]"].join(""):[encode(e,r),"[",encode(n,r),"]=",encode(t,r)].join("")};case"bracket":return function(e,t){return null===t?encode(e,r):[encode(e,r),"[]=",encode(t,r)].join("")};default:return function(e,t){return null===t?encode(e,r):[encode(e,r),"=",encode(t,r)].join("")}}}function parserForArrayFormat(r){var e;switch(r.arrayFormat){case"index":return function(r,t,n){e=/\[(\d*)\]$/.exec(r);r=r.replace(/\[\d*\]$/,"");if(e){void 0===n[r]&&(n[r]={});n[r][e[1]]=t}else n[r]=t};case"bracket":return function(r,t,n){e=/(\[\])$/.exec(r);r=r.replace(/\[\]$/,"");e?void 0!==n[r]?n[r]=[].concat(n[r],t):n[r]=[t]:n[r]=t};default:return function(r,e,t){void 0!==t[r]?t[r]=[].concat(t[r],e):t[r]=e}}}function encode(r,e){return e.encode?e.strict?o(r):encodeURIComponent(r):r}function keysSorter(r){return Array.isArray(r)?r.sort():"object"===typeof r?keysSorter(Object.keys(r)).sort((function(r,e){return Number(r)-Number(e)})).map((function(e){return r[e]})):r}function extract(r){var e=r.indexOf("?");return-1===e?"":r.slice(e+1)}function parse(r,e){e=c({arrayFormat:"none"},e);var t=parserForArrayFormat(e);var n=Object.create(null);if("string"!==typeof r)return n;r=r.trim().replace(/^[?#&]/,"");if(!r)return n;r.split("&").forEach((function(r){var e=r.replace(/\+/g," ").split("=");var o=e.shift();var c=e.length>0?e.join("="):void 0;c=void 0===c?null:a(c);t(a(o),c,n)}));return Object.keys(n).sort().reduce((function(r,e){var t=n[e];Boolean(t)&&"object"===typeof t&&!Array.isArray(t)?r[e]=keysSorter(t):r[e]=t;return r}),Object.create(null))}n.extract=extract;n.parse=parse;n.stringify=function(r,e){var t={encode:true,strict:true,arrayFormat:"none"};e=c(t,e);false===e.sort&&(e.sort=function(){});var n=encoderForArrayFormat(e);return r?Object.keys(r).sort(e.sort).map((function(t){var o=r[t];if(void 0===o)return"";if(null===o)return encode(t,e);if(Array.isArray(o)){var c=[];o.slice().forEach((function(r){void 0!==r&&c.push(n(t,r,c.length))}));return c.join("&")}return encode(t,e)+"="+encode(o,e)})).filter((function(r){return r.length>0})).join("&"):""};n.parseUrl=function(r,e){return{url:r.split("?")[0]||"",query:parse(extract(r),e)}};const i=n.stringify,u=n.parseUrl;const s=n.extract,f=n.parse;export default n;export{s as extract,f as parse,u as parseUrl,i as stringify};

